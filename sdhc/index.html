<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
	<link rel='stylesheet' type='text/css' href='tomato.css' />
	<title>Tomato firmware with SDHC mod</title>
	<meta name="Description" content="Modified Tomato firmware for Linksys WRT54G/GS/GL routers with
	SDHC cards internal storage support added (with GUI)" />
	<meta name="Keywords" content="Tomato, firmware, download, wrt54g, linksys, mmc, mod, sdhc, sd, card" />
	<meta http-equiv="Content-Language" content="en" />
	<meta name="Author" content="Tomasz Słodkowicz" />
	<meta http-equiv="Creation-Date" content="Wed, 11 Feb 2009 21:00:00 GMT" />
	<meta name="Generator" content="vim" />
	<meta name="Robots" content="nofollow" />
	<link rel="Bookmark" title="Tomato firmware with SDHC mod" href="http://gemini.net.pl/~slodki/tomato-sdhc.html" />
</head>
<body>
	<h1>Tomato firmware with SDHC mod - homepage</h1>

	<h2>Description</h2>
	<p>This is a firmware for <a href="http://www.linksysbycisco.com/US/en/products/WRT54GL">Linksys
	routers</a> based on great <a	href="http://www.polarcloud.com/tomato">Tomato firmware</a> with
	additional <a href="http://en.wikipedia.org/wiki/Secure_Digital_card">Secure Digital</a>,
	<a href="http://en.wikipedia.org/wiki/Secure_Digital_card#SDHC">Secure Digital High Capacity</a>,
	<a href="http://en.wikipedia.org/wiki/Multimedia_Card">MMC</a> cards support.</p>

	<h3>Features</h3>
	<ul>	<li>All great features of Tomato firmware ver. 1.28</li>
		<li>New optimized SDHC/MMC driver ver. 2.0.1 - this adds up to 32GB build-in storage on flash memory</li>
		<li>Higher transfers then previous mmc driver ver. 1.3.5 - +40% writing, +10% reading</li>
		<li>GPIO pins parametres selectable via GUI</li>
		<li>Detailed card ID data avaiable via GUI</li>
		<li>Support for mounting ext2, ext3 and vfat partitions</li>
	</ul>

	<h3>Supported hardware</h3>
	<p>Should be the same as original Tomato firmware:</p>
	<ul>	<li>Linksys WRT54G v1-v4, WRT54GS v1-v4, WRT54GL v1.x, WRTSL54GS (no USB support)</li>
		<li>Buffalo WHR-G54S, WHR-HP-G54, WZR-G54, WBR2-G54, WBR-G54, WZR-HP-G54, WZR-RS-G54, WZR-RS-G54HP,
		WVR-G54-NF, WHR2-A54-G54, WHR3-AG54</li>
		<li>Asus WL500G Premium (no USB support), WL500GE, WL520GU (no USB support)</li>
		<li>Sparklan WX6615GT, Fuji RT390W, Microsoft MN-700</li>
	</ul>
	<p>I'm not sure if all above routers support SDHC/MMC hardware mod. This version of SDHC/MMC driver
	may not work with other	then Linksys WRT54G/GS/GL routers.</p>
	<p>For routers with USB ports you should use firmware with USB support - USB has a higher
	transfer then SDHC/MMC in SPI (slow) mode.</p>

	<h3>Screenshots</h3>
	<ul>	<li><a href="tomato-sdhc.png">GUI webpage</a></li>
		<li>Example <a href="toshiba.log">SDHC card initialization log</a> (from syslog)</li>
	</ul>
	<p>More screenshots at <a href="http://www.polarcloud.com/tomato">Tomato homepage</a>.</p>

	<h2>Authors</h2>
	<ul>	<li>Jonathan Zarate - original <a href="http://www.polarcloud.com/tomato">Tomato firmware</a></li>
		<li>Augusto Bott - original Tomato SD/MMC mod</li>
		<li>Roadkill - <a href="http://www.linksysinfo.org/forums/showthread.php?t=53233">
		Roadkill OpenVPN Mod</a> with SD/MMC support</li>
		<li>Keith Moyer - <a href="http://tomatovpn.keithmoyer.com/">TomatoVPN</a> mod</li>
		<li>Fedor Kozhevnikov and Ray Van Tassle - <a href="http://tomatousb.org/">TomatoUSB</a> mod</li>
		<li>Chris Krusch - new <a href="http://4mul8.ca/openwrt/source/">SDHC/MMC driver</a></li>
		<li>Tomasz Słodkowicz - merging new SDHC driver into Tomato and GUI update</li>
	</ul>

	<h2>Documentation</h2>
	<ul>	<li><a href="http://wiki.openwrt.org/OpenWrtDocs/Customizing/Hardware/MMC">Hardware
		modification for SDHC/MMC description</a> for different router models, at OpenWrt Wiki</li>
		<li>Tomato <a href="http://www.polarcloud.com/tomatofaq">FAQ</a></li>
		<li>Tomato <a href="http://en.wikibooks.org/wiki/Tomato_Firmware">Wikibook</a></li>
		<li>LinksysInfo <a href="http://www.linksysinfo.org/forums/forumdisplay.php?f=160">Tomato
		forum</a></li>
		<li>Info about different <a href="http://www.linksysinfo.org/forums/showthread.php?t=57933">Tomato modifications</a> avaiable</li>
		<li><a href="http://lampiweb.com/virtual/tomatok26/status-index.html">Tomato simulator</a> for latest 1.28 modified Tomato firmware</li>
		<li>SDHC/MMC v2.0.1 <a href="http://repo.or.cz/w/tomato.git?a=blob;f=release/src/router/mmc/mmc.c;hb=tomato-sdhc">driver documentation</a> (parameters, tuning etc.)</li>
	</ul>

	<h2>Download</h2>
	<p><strong>This firmware is provided as-is without any warranty. I will not be responsible for damages that
	occur due to the use of this firmware. Use at your own risk!</strong>
	The binary firmware files are compressed in <a href="http://en.wikipedia.org/wiki/7z">7z</a> format.</p>
	<h3>tomato-slodki</h3>
	<p>This is Tomato firmware with SDHC/MMC support added and many others improvements. The 1.25.01 and 1.28.01 versions
	have additional features from <a href="http://tomatovpn.keithmoyer.com/">TomatoVPN</a> mod.
	The 1.28.02 version is copy of <a href="http://tomatousb.org/">TomatoUSB</a> 1.28.8754
	(<a href="http://tomatousb.org/doc:build-features-cross-reference">build e</a>) with SDHC support and without JFFS.
	For details see changelog.</p>
	<ul>
		<li><a href="tomato-slodki-ND-1.28.02.7z">tomato-slodki-ND-1.28.02</a> -
		<a href="http://repo.or.cz/w/tomato.git?a=tree;hb=tomato-slodki-ND-1.28.02">sources</a>,
		<a href="http://repo.or.cz/w/tomato.git?a=shortlog;h=refs/tags/tomato-slodki-ND-1.28.02">changelog</a></li>
		<li><a href="tomato-slodki-ND-1.28.01.7z">tomato-slodki-ND-1.28.01</a> -
		<a href="http://repo.or.cz/w/tomato.git?a=tree;hb=tomato-slodki-ND-1.28.01">sources</a>,
		<a href="http://repo.or.cz/w/tomato.git?a=shortlog;h=refs/tags/tomato-slodki-ND-1.28.01">changelog</a></li>
		<li><a href="tomato-slodki-1.25.01.7z">tomato-slodki-1.25.01</a> -
		<a href="http://repo.or.cz/w/tomato.git?a=tree;hb=tomato-slodki-1.25.01">sources</a>,
		<a href="http://repo.or.cz/w/tomato.git?a=shortlog;h=refs/tags/tomato-slodki-1.25.01">changelog</a></li>
	</ul>
	<h3>tomato-sdhc</h3>
	<p>This is clean original Tomato firmware with SDHC/MMC support added.</p>
	<ul>
		<li><a href="tomato-sdhc-ND-1.28.01.7z">tomato-sdhc-ND-1.28.01</a> -
		<a href="http://repo.or.cz/w/tomato.git?a=tree;hb=tomato-sdhc-ND-1.28.01">sources</a>,
		<a href="http://repo.or.cz/w/tomato.git?a=shortlog;h=refs/tags/tomato-sdhc-ND-1.28.01">changelog</a></li>
		<li><a href="tomato-sdhc-1.28.01.7z">tomato-sdhc-1.28.01</a> -
		<a href="http://repo.or.cz/w/tomato.git?a=tree;hb=tomato-sdhc-1.28.01">sources</a>,
		<a href="http://repo.or.cz/w/tomato.git?a=shortlog;h=refs/tags/tomato-sdhc-1.28.01">changelog</a></li>
<!--
		<li><a href="tomato-sdhc-1.25.01.7z">tomato-sdhc-1.25.01</a> -
		<a href="http://repo.or.cz/w/tomato.git?a=tree;hb=tomato-sdhc-1.25.01">sources</a>,
		<a href="http://repo.or.cz/w/tomato.git?a=shortlog;h=refs/tags/tomato-sdhc-1.25.01">changelog</a></li>
		<li><a href="tomato-sdhc-1.23.02.7z">tomato-sdhc-1.23.02</a> -
		<a href="http://repo.or.cz/w/tomato.git?a=tree;hb=tomato-sdhc-1.23.02">sources</a>,
		<a href="http://repo.or.cz/w/tomato.git?a=shortlog;h=refs/tags/tomato-sdhc-1.23.02">changelog</a></li>
		<li><a href="tomato-sdhc-1.23.01.7z">tomato-sdhc-1.23.01</a> -
		<a href="http://repo.or.cz/w/tomato.git?a=tree;hb=tomato-sdhc-1.23.01">sources</a>,
		<a href="http://repo.or.cz/w/tomato.git?a=shortlog;h=refs/tags/tomato-sdhc-1.23.01">changelog</a></li>
-->
	</ul>
	<p>You could also download <a href="http://www.bitsum.com/firmware_mod_kit.htm">Firmware Modification Kit</a>
	to extract the binary firmware or even to repack it with additional or modified files!</p>

	<h2>Benchmarks</h2>
	<p>Testing environment: WRT54GL v1.1 with SD mod, clkfreq=225.</p>
	<p>Testing method:
		<code>mount -t ext3 /dev/mmc/disc0/part1 /mmc<br/>
		sync; date; dd if=/dev/zero of=/mmc/test.bin bs=1024 count=102400; sync; date<br/>
		sync; date; dd if=/mmc/test.bin of=/dev/null bs=1024 count=102400; sync; date</code></p>
	<p>Results:</p>
		<table><tr><th rowspan="2">Card tested</th><th colspan="2">SD driver v1.3.5</th>
				<th colspan="2">SDHC driver v2.0.1</th><th colspan="2">USB 2.0 card reader (PC)</th></tr>
			<tr><th>write</th><th>read</th><th>write</th><th>read</th><th>write</th><th>read</th></tr>
			<tr><td>Kingston microSD 2GB</td><td>404 KB/s</td><td>446 KB/s</td><td>572 KB/s</td><td>474 KB/s</td><td>8 MB/s</td><td>18 MB/s</td></tr>
			<tr><td>Toshiba SDHC 4GB</td><td></td><td></td><td>781 KB/s</td><td>451 KB/s</td><td>13 MB/s</td><td>18.2 MB/s</td></tr>
		</table>

	<h2>Changelog</h2>
	<p>The log of all changes in this mod and current status of development is avaiable at the git
	<a href="http://repo.or.cz/w/tomato.git?a=shortlog;h=refs/heads/tomato-slodki">Tomato repository</a>.</p>

	<h2>Sources</h2>
	<p>Sources for this version of Tomato firmware are avaiable at the git repository for
	<a href="http://repo.or.cz/w/tomato.git?a=tree;h=refs/heads/tomato-sdhc;hb=tomato-slodki">on-line browsing</a>.
	For compiling instruction please read
	<a href="http://repo.or.cz/w/tomato.git?a=blob_plain;f=README.TXT;hb=tomato">README.TXT</a> file.
	For git commands - please see the <a href="http://git-scm.com/documentation">tutorials</a> at Git homepage.</p>

	<h2>TODO</h2>
	<ul>	<li>Autodetection of partition type</li>
		<li>Allow to mount more then 1 partition</li>
		<li>Write a mini-HOWTO about running additional software form SDHC</li>
		<li>Add fsck and run it before mounting</li>
	</ul>

	<address>Last updated 2011-02-18 by Tomasz Słodkowicz, visits:
	<a href="http://www.licz.pl" title="Darmowe Liczniki">
	<script src="http://www.licz.pl/counter.php?name=tomatosdhc" type="text/javascript"></script></a>
	<a href="http://www.licz.pl"><img src="http://www.licz.pl/donotalterthecode.gif" width="5" height="5" alt=""/></a>
	</address>
</body>
</html>
